<!DOCTYPE html>
<!-- SPDX-License-Identifier: AGPL-3.0-or-later -->
<!-- This file is part of MLX DeepSeek-OCR. Licensed under the GNU Affero General Public License v3.0 (AGPL-3.0). -->
<!-- See the LICENSE file in the project root for full license text: https://www.gnu.org/licenses/agpl-3.0.en.html -->
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MLX DeepSeek-OCR - å®Œæ¥µæœ¬åœ°ç‰ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- é€™æ˜¯ä¿®æ­£ä¸¦æ•´åˆå¾Œçš„æœ€çµ‚ç‰ˆæœ¬ï¼Œè«‹ç”¨å®ƒä¾†å–ä»£æ‚¨èˆŠçš„ <style> å€å¡Š -->
    <style type="text/tailwindcss">
        /* 
          æ³¨æ„ï¼šé€™è£¡çš„ <style> æ¨™ç±¤å·²æ–°å¢ type="text/tailwindcss"ï¼Œ
          é€™æ˜¯è®“ @apply æŒ‡ä»¤èƒ½å¤ æ­£å¸¸é‹ä½œçš„å¿…è¦æ­¥é©Ÿã€‚
        */

        /* --- æ‹–æ”¾å€å¡Šèˆ‡è¼‰å…¥å‹•ç•« (ä¿ç•™ä¸è®Š) --- */
        .drop-zone {
            border: 2px dashed #cbd5e0;
            transition: all 0.3s ease;
        }
        .drop-zone.dragover {
            border-color: #4299e1;
            background-color: #ebf8ff;
        }
        .spinner {
            border: 3px solid #f3f4f6;
            border-top: 3px solid #a78bfa;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* --- åŠŸèƒ½åˆ†é  (ä¿ç•™ä¸è®Š) --- */
        .mode-tab {
            transition: all 0.3s ease;
        }
        .mode-tab.active {
            background: linear-gradient(135deg, #8b5cf6 0%, #a78bfa 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.4);
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }

        /* â–¼â–¼â–¼ é€™è£¡æ˜¯ä¿®æ”¹å¾Œçš„ç¨‹å¼ç¢¼ â–¼â–¼â–¼ */
        /* --- PDF é è¦½ç¸®åœ– --- */
        .thumbnail-item {
            /*
              ä¿®æ”¹èªªæ˜ï¼š
              - çµ±ä¸€ä½¿ç”¨ Tailwind çš„ @apply æŒ‡ä»¤ã€‚
              - èª¿æ•´ hover æ•ˆæœç‚ºç°è‰²é‚Šæ¡†ï¼Œèˆ‡é¸ä¸­çš„ç´«è‰²åšå€åˆ†ã€‚
              - å¢åŠ  p-1 å…§è·ï¼Œè®“è¦–è¦ºæ›´èˆ’é©ã€‚
            */
            @apply cursor-pointer transition-all duration-200 border-2 border-transparent hover:border-gray-300 rounded-lg overflow-hidden p-1;
        }

        .thumbnail-item.selected {
            /*
              ä¿®æ”¹èªªæ˜ï¼š
              - å®Œå…¨æ”¹ç”¨ @apply çš„å¯«æ³•ï¼Œé¢¨æ ¼çµ±ä¸€ã€‚
              - ä½¿ç”¨ border-purple-500 å’Œ ring å·¥å…·é¡å–ä»£æ‰‹å¯«çš„ border-color å’Œ box-shadowã€‚
              - ring æ˜¯ Tailwind ä¸­å¯¦ç¾å¤–å…‰æšˆæ•ˆæœçš„æœ€ä½³å¯¦è¸ã€‚
            */
            @apply border-purple-500 ring-2 ring-purple-300;
        }

        .thumbnail-item img {
            /*
              ä¿®æ”¹èªªæ˜ï¼š
              - å¢åŠ åœ“è§’ï¼Œä½¿å…¶èˆ‡çˆ¶å®¹å™¨çš„åœ“è§’åŒ¹é…ã€‚
            */
            @apply w-full h-full object-cover rounded;
        }
        /* â–²â–²â–² ä¿®æ”¹çµæŸ â–²â–²â–² */


        /* --- å…¶ä»– UI å…ƒä»¶ (ä¿ç•™ä¸è®Š) --- */
        .info-banner {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .info-banner h3 {
            margin: 0 0 10px 0;
            font-size: 1.3em;
        }
        .hint-box {
            background: #fff3cd;
            border: 1px solid #ffc107;
            padding: 10px 15px;
            border-radius: 5px;
            margin-bottom: 15px;
        }
        .option-label {
            display: block;
            padding: 12px;
            margin: 8px 0;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .option-label:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }
        .option-label input[type="checkbox"]:checked + span {
            color: #667eea;
            font-weight: bold;
        }
        .option-description {
            display: block;
            color: #666;
            margin-top: 5px;
            font-size: 0.9em;
        }
        .preset-btn {
            padding: 12px 24px;
            margin: 5px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
        }
        .preset-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-50 via-pink-50 to-blue-50 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-7xl">
        <header class="text-center mb-8">
            <h1 class="text-5xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent mb-2">
                MLX DeepSeek-OCR
            </h1>
            <p class="text-xl text-gray-700">Apple Silicon åŸç”Ÿ Â· 4bit æ¥µé€Ÿ Â· å®Œå…¨é›¢ç·š</p>
        </header>

        <!-- æ¨™ç±¤å°èˆª -->
        <div class="flex space-x-4 mb-6">
            <button id="tab-ocr" class="tab-btn active px-6 py-3 rounded-xl font-bold text-lg bg-purple-600 text-white shadow-lg">
                ğŸ“„ OCR è¾¨è­˜
            </button>
            <button id="tab-video" class="tab-btn px-6 py-3 rounded-xl font-bold text-lg bg-gray-200 text-gray-700 hover:bg-gray-300">
                ğŸ¬ å½±ç‰‡æˆªåœ–
            </button>
            <button id="tab-preprocess" disabled class="tab-btn px-6 py-3 rounded-xl font-bold text-lg bg-gray-200 text-gray-700 hover:bg-gray-300 opacity-50 cursor-not-allowed" title="ç¨ç«‹å‰è™•ç†åŠŸèƒ½å·²ç¦ç”¨ï¼Œè«‹ä½¿ç”¨ OCR Tab æˆ–å½±ç‰‡æˆªåœ– Tab ä¸­çš„å‰è™•ç†åŠŸèƒ½">
                ğŸ¨ ç…§ç‰‡å‰è™•ç†
            </button>
        </div>

        <div class="grid grid-cols-1 xl:grid-cols-3 gap-6">
            <!-- å·¦å´ï¼šä¸Šå‚³ + è¨­å®š + é è¦½ -->
            <div class="xl:col-span-1 space-y-6">
                
                <!-- OCR è¾¨è­˜ Tab -->
                <div id="tab-ocr-content" class="tab-content active">
                    <div class="bg-white rounded-2xl shadow-xl p-6">
                        <h2 class="text-2xl font-bold mb-4 text-gray-800">ä¸Šå‚³æª”æ¡ˆ</h2>
                        
                        <div id="dropZone" class="drop-zone rounded-xl p-10 text-center cursor-pointer mb-4 bg-gray-50 hover:bg-gray-100">
                            <svg class="mx-auto h-16 w-16 text-purple-500" stroke="currentColor" fill="none" viewBox="0 0 48 48">
                                <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                            <p class="mt-3 text-lg font-medium text-gray-700">æ‹–æ”¾æª”æ¡ˆåˆ°é€™è£¡</p>
                            <p class="mt-1 text-sm text-gray-500">æ”¯æ´ JPGã€PNGã€PDFï¼ˆæœ€å¤§ 32MBï¼‰</p>
                            <input type="file" id="fileInput" accept="image/*,application/pdf" class="hidden">
                        </div>

                        <!-- åœ–ç‰‡å‰è™•ç†é¸é …ï¼ˆåœ–ç‰‡å°ˆç”¨ï¼‰ -->
                        <div id="imagePreprocessSection" class="hidden space-y-4 mb-4">
                            <div class="p-5 bg-yellow-50 rounded-xl border-2 border-yellow-200">
                                <h3 class="text-lg font-bold text-yellow-800 mb-3">ğŸ¨ ç…§ç‰‡å‰è™•ç†é¸é …ï¼ˆå¯é¸ï¼‰</h3>
                                <p class="text-sm text-yellow-700 mb-4">é¸æ“‡è™•ç†é¸é …å¾Œï¼Œç³»çµ±æœƒåœ¨OCRè¾¨è­˜å‰è‡ªå‹•è™•ç†åœ–ç‰‡</p>
                                
                                <div class="space-y-3 mb-4">
                                    <label class="flex items-start space-x-3 cursor-pointer">
                                        <input type="checkbox" id="imageAutoRotate" class="mt-1 rounded text-purple-600">
                                        <div>
                                            <span class="font-medium text-gray-800">ğŸ”„ è‡ªå‹•æ—‹è½‰</span>
                                            <p class="text-xs text-gray-600">è‡ªå‹•æª¢æ¸¬ä¸¦ä¿®æ­£åœ–ç‰‡å‚¾æ–œè§’åº¦</p>
                                        </div>
                                    </label>
                                    
                                    <label class="flex items-start space-x-3 cursor-pointer">
                                        <input type="checkbox" id="imageEnhance" class="mt-1 rounded text-purple-600">
                                        <div>
                                            <span class="font-medium text-gray-800">âœ¨ å¢å¼·å°æ¯”+éŠ³åŒ–</span>
                                            <p class="text-xs text-gray-600">è®“åœ–ç‰‡æ›´æ¸…æ™°ï¼Œå°æ¯”æ›´æ˜é¡¯</p>
                                        </div>
                                    </label>
                                    
                                    <label class="flex items-start space-x-3 cursor-pointer">
                                        <input type="checkbox" id="imageRemoveShadows" class="mt-1 rounded text-purple-600">
                                        <div>
                                            <span class="font-medium text-gray-800">â˜€ï¸ å»é™¤é™°å½±</span>
                                            <p class="text-xs text-gray-600">ç§»é™¤å…‰ç·šä¸å‡é€ æˆçš„é™°å½±</p>
                                        </div>
                                    </label>
                                    
                                    <label class="flex items-start space-x-3 cursor-pointer">
                                        <input type="checkbox" id="imageBinarize" class="mt-1 rounded text-purple-600">
                                        <div>
                                            <span class="font-medium text-gray-800">âš«âšª äºŒå€¼åŒ–</span>
                                            <p class="text-xs text-gray-600">è½‰æ›æˆç´”é»‘ç™½åœ–ï¼ˆâš ï¸ ä¸å¯é€†ï¼‰</p>
                                        </div>
                                    </label>
                                    
                                    <label class="flex items-start space-x-3 cursor-pointer">
                                        <input type="checkbox" id="imageRemoveBg" class="mt-1 rounded text-purple-600">
                                        <div>
                                            <span class="font-medium text-gray-800">ğŸ¨ å»é™¤èƒŒæ™¯ (AI)</span>
                                            <p class="text-xs text-gray-600">ä½¿ç”¨ rembg AI æ¨¡å‹æ™ºèƒ½å»èƒŒ</p>
                                        </div>
                                    </label>
                                </div>
                                
                                <div class="flex space-x-3 mt-4">
                                    <button id="skipImagePreprocessBtn" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-xl shadow-lg transition">
                                        è·³éå‰è™•ç†
                                    </button>
                                    <button id="executeImagePreprocessBtn" class="flex-1 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-bold py-3 px-6 rounded-xl shadow-lg transition">
                                        åŸ·è¡Œå‰è™•ç†
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- é…ç½®é¸æ“‡é¢æ¿ -->
                        <div id="configPanel" class="hidden space-y-4 mb-4">
                            <!-- Mode é¸æ“‡ -->
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">ğŸ“„ å…§å®¹é¡å‹</label>
                                <select id="modeSelect" class="w-full border-2 border-purple-200 rounded-xl px-4 py-3 focus:outline-none focus:ring-4 focus:ring-purple-300">
                                    <option value="Document">Document Mode (çµæ§‹åŒ–å…§å®¹)</option>
                                    <option value="Scene">Scene Mode (ç¾å ´æ–‡å­—)</option>
                                </select>
                            </div>

                            <!-- Subcategory é¸æ“‡ -->
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">ğŸ“š ç´°åˆ†é¡åˆ¥</label>
                                <select id="subcategorySelect" class="w-full border-2 border-blue-200 rounded-xl px-4 py-3 focus:outline-none focus:ring-4 focus:ring-blue-300">
                                    <option value="Academic">Academic</option>
                                </select>
                            </div>

                            <!-- Complexity æ»‘å¡Š -->
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">ğŸšï¸ è¤‡é›œåº¦ï¼š<span id="complexityLabel">Medium (256 tokens) â­ æ¨è–¦</span></label>
                                <input type="range" id="complexitySlider" min="0" max="4" value="2" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                                <div class="flex justify-between text-xs text-gray-500 mt-1">
                                    <span>Tiny (64)</span>
                                    <span>Small (100)</span>
                                    <span>Medium (256)</span>
                                    <span>Large (400)</span>
                                    <span>Gundam (800)</span>
                                </div>
                            </div>
                        </div>

                        <!-- PDF æ¨¡å¼åˆ‡æ› -->
                        <div id="pdfModeSection" class="hidden space-y-4">
                            <div class="flex space-x-3">
                                <button id="batchModeBtn" class="flex-1 mode-tab active py-4 px-6 rounded-xl font-bold text-lg shadow-lg">
                                    æ‰¹æ¬¡è™•ç†
                                </button>
                                <button id="singleModeBtn" class="flex-1 mode-tab py-4 px-6 rounded-xl font-bold text-lg bg-gray-50 text-gray-700">
                                    å–®é è¾¨è­˜
                                </button>
                            </div>

                            <!-- PDF å‰è™•ç†æŒ‰éˆ•ï¼ˆåˆ‡æ›åˆ°å‰è™•ç†Tabï¼‰ -->
                            <div id="pdfPreprocessSection" class="hidden p-5 bg-yellow-50 rounded-xl border-2 border-yellow-200">
                                <h3 class="text-lg font-bold text-yellow-800 mb-3">ğŸ¨ PDFå‰è™•ç†é¸é …ï¼ˆå¯é¸ï¼‰</h3>
                                <p class="text-sm text-yellow-700 mb-4">é»æ“Šä¸‹æ–¹æŒ‰éˆ•å°‡PDFé é¢æå–ç‚ºåœ–ç‰‡ï¼Œç„¶å¾Œåœ¨å‰è™•ç†Tabä¸­é€²è¡Œè™•ç†</p>
                                
                                <div class="flex space-x-3">
                                    <button id="skipPdfPreprocessBtn" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-xl shadow-lg transition">
                                        è·³éå‰è™•ç†
                                    </button>
                                    <button id="executePdfPreprocessBtn" class="flex-1 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-bold py-3 px-6 rounded-xl shadow-lg transition">
                                        å‰å¾€å‰è™•ç†
                                    </button>
                                </div>
                            </div>

                            <!-- æ‰¹æ¬¡è¨­å®š -->
                            <div id="batchSettings" class="p-5 bg-purple-50 rounded-xl border-2 border-purple-200">
                                <p class="text-sm font-bold text-purple-800 mb-3">æ¯æ‰¹æ¬¡è™•ç†é æ•¸</p>
                                <select id="batchSize" class="w-full border-2 border-purple-300 rounded-lg px-4 py-3">
                                    <option value="2" selected>2 é ï¼ˆæ¨è–¦ï¼‰</option>
                                    <option value="1">1 é ï¼ˆæœ€ç©©ï¼‰</option>
                                    <option value="3">3 é </option>
                                    <option value="5">5 é </option>
                                    <option value="10">10 é </option>
                                    <option value="custom">è‡ªè¨‚</option>
                                </select>
                                <input type="number" id="customBatchSize" class="hidden w-full mt-2 border-2 border-purple-300 rounded-lg px-4 py-3" min="1" max="50" value="5" placeholder="è¼¸å…¥è‡ªè¨‚é æ•¸ (1-50)">
                                <div id="batchValidationError" class="hidden mt-2 text-sm text-red-600"></div>
                            </div>

                            <!-- å–®é è¨­å®š -->
                            <div id="singleSettings" class="hidden p-5 bg-blue-50 rounded-xl border-2 border-blue-200">
                                <p class="text-sm font-bold text-blue-800 mb-3">é¸æ“‡é é¢</p>
                                <select id="pageSelector" class="w-full border-2 border-blue-300 rounded-lg px-4 py-3"></select>
                            </div>
                        </div>

                        <!-- åŸ·è¡ŒæŒ‰éˆ• -->
                        <div class="mt-6 space-y-3">
                            <button id="processBatchBtn" class="hidden w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-bold py-4 px-6 rounded-xl shadow-xl text-xl transition transform hover:scale-105">
                                <span id="batchBtnText">é–‹å§‹æ‰¹æ¬¡è™•ç†</span>
                            </button>
                            <button id="processSingleBtn" class="hidden w-full bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white font-bold py-4 px-6 rounded-xl shadow-xl text-xl transition transform hover:scale-105">
                                <span id="singleBtnText">è¾¨è­˜æ­¤é </span>
                            </button>
                            <button id="processImageBtn" class="hidden w-full bg-gradient-to-r from-green-600 to-teal-600 hover:from-green-700 hover:to-teal-700 text-white font-bold py-4 px-6 rounded-xl shadow-xl text-xl transition transform hover:scale-105">
                                <span id="imageBtnText">é–‹å§‹è¾¨è­˜</span>
                            </button>
                        </div>
                    </div>

                    <!-- ç¸®åœ–åˆ—è¡¨ -->
                    <div id="thumbnails" class="hidden bg-white rounded-2xl shadow-xl p-4 max-h-96 overflow-y-auto">
                        <p class="text-sm font-bold text-gray-700 mb-3">é»æ“Šç¸®åœ–åˆ‡æ›é é¢</p>
                        <div id="thumbnailsGrid" class="grid grid-cols-3 gap-3"></div>
                    </div>

                    <!-- é è¦½å€ -->
                    <div class="bg-white rounded-2xl shadow-xl p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-bold text-gray-800">é è¦½</h3>
                            <div class="space-x-2">
                                <button onclick="zoomPreview(1.2)" class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold w-10 h-10 rounded-full shadow">+</button>
                                <button onclick="zoomPreview(0.8)" class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold w-10 h-10 rounded-full shadow">âˆ’</button>
                                <button id="clearBtn" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg shadow">æ¸…é™¤</button>
                            </div>
                        </div>
                        <div id="preview" class="hidden relative bg-gray-100 rounded-xl overflow-hidden border-4 border-gray-300">
                            <img id="previewImage" class="w-full transition-transform duration-200" style="transform: scale(1)" alt="é è¦½">
                        </div>
                    </div>
                </div>

                
                <div id="tab-preprocess-content" class="tab-content">
                    <!-- é ‚éƒ¨èªªæ˜æ©«å¹… -->
                    <div class="info-banner">
                        <h3>ğŸ¨ é—œæ–¼ã€Œå»é™¤èƒŒæ™¯ã€åŠŸèƒ½</h3>
                        <p>
                            âœ… ä½¿ç”¨ <strong>rembg AI æ¨¡å‹</strong>ï¼Œèˆ‡æ‚¨çš„ Colab ä»£ç¢¼<strong>å®Œå…¨ç›¸åŒ</strong><br>
                            âœ… åªéœ€å‹¾é¸ã€Œå»é™¤èƒŒæ™¯ã€é¸é …ï¼Œæˆ–é»æ“Šã€ŒğŸ¨ åƒ…å»èƒŒæ™¯ã€å¿«é€ŸæŒ‰éˆ•<br>
                            âœ… è¼¸å‡ºç‚ºé€æ˜èƒŒæ™¯ PNG æ ¼å¼<br>
                            ğŸ’¡ å¦‚éœ€ç´”å»èƒŒï¼ˆä¸åšå…¶ä»–è™•ç†ï¼‰ï¼Œé»æ“Šã€ŒğŸ¨ åƒ…å»èƒŒæ™¯ã€æŒ‰éˆ•å³å¯
                        </p>
                    </div>

                    <div class="bg-white rounded-2xl shadow-xl p-6">
                        <h2 class="text-2xl font-bold mb-4 text-gray-800">ç…§ç‰‡å‰è™•ç†</h2>
                        
                        <div class="hint-box">
                            ğŸ’¡ æç¤ºï¼šå¦‚æœä¸å‹¾é¸ä»»ä½•é¸é …ï¼Œå°‡ä¿å­˜åŸåœ–ï¼ˆä¸åšä»»ä½•è™•ç†ï¼‰<br>
                            ğŸ’¡ æç¤ºï¼šå¯ä»¥å¤šé¸ï¼Œç³»çµ±æœƒä¾åºè™•ç†æ‰€æœ‰é¸é …
                        </div>
                        
                        <div id="preprocessDropZone" class="drop-zone rounded-xl p-8 text-center cursor-pointer mb-4 bg-gray-50 hover:bg-gray-100 border-2 border-dashed border-purple-300">
                            <svg class="mx-auto h-12 w-12 text-purple-500" stroke="currentColor" fill="none" viewBox="0 0 48 48">
                                <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                            <p class="mt-3 text-lg font-medium text-gray-700">æ‹–æ”¾ç…§ç‰‡åˆ°é€™è£¡</p>
                            <p class="mt-1 text-sm text-gray-500">æ”¯æ´ JPGã€PNGï¼ˆå¯å¤šé¸ï¼‰</p>
                            <input type="file" id="preprocessFileInput" accept="image/*" multiple disabled class="hidden">
                        </div>

                        <!-- å‰è™•ç†è¨­å®š -->
                        <div id="preprocessSettings" class="space-y-4 mb-4 hidden">
                            <div>
                                <h3 class="text-lg font-bold text-gray-800 mb-3">è™•ç†é¸é …ï¼ˆå¯å¤šé¸ï¼‰</h3>
                                
                                <label class="option-label">
                                    <input type="checkbox" id="autoRotate" class="rounded text-purple-600">
                                    <span>ğŸ”„ è‡ªå‹•æ—‹è½‰</span>
                                    <span class="option-description">è‡ªå‹•æª¢æ¸¬ä¸¦ä¿®æ­£åœ–ç‰‡å‚¾æ–œè§’åº¦ï¼ˆé©åˆæ‰‹æ©Ÿæ‹æ”çš„æ­ªæ–œç…§ç‰‡ï¼‰</span>
                                </label>
                                
                                <label class="option-label">
                                    <input type="checkbox" id="enhance" class="rounded text-purple-600">
                                    <span>âœ¨ å¢å¼·å°æ¯”+éŠ³åŒ–</span>
                                    <span class="option-description">è®“åœ–ç‰‡æ›´æ¸…æ™°ï¼Œå°æ¯”æ›´æ˜é¡¯ï¼ˆé©åˆæ¨¡ç³Šã€ç°æ¿›æ¿›çš„ç…§ç‰‡ï¼‰</span>
                                </label>
                                
                                <label class="option-label">
                                    <input type="checkbox" id="removeShadows" class="rounded text-purple-600">
                                    <span>â˜€ï¸ å»é™¤é™°å½±</span>
                                    <span class="option-description">ç§»é™¤å…‰ç·šä¸å‡é€ æˆçš„é™°å½±ï¼ˆé©åˆæœ‰é™°å½±çš„æ–‡ä»¶æƒæï¼‰</span>
                                </label>
                                
                                <label class="option-label">
                                    <input type="checkbox" id="binarize" class="rounded text-purple-600">
                                    <span>âš«âšª äºŒå€¼åŒ–</span>
                                    <span class="option-description">è½‰æ›æˆç´”é»‘ç™½åœ–ï¼ˆé©åˆæ–‡å­—è¾¨è­˜ã€åˆ—å°ï¼Œâš ï¸ ä¸å¯é€†ï¼‰</span>
                                </label>
                                
                                <label class="option-label">
                                    <input type="checkbox" id="removeBg" class="rounded text-purple-600">
                                    <span>ğŸ¨ å»é™¤èƒŒæ™¯ (AI)</span>
                                    <span class="option-description">
                                        <strong>ä½¿ç”¨ rembg AI æ¨¡å‹æ™ºèƒ½å»èƒŒ</strong><br>
                                        â€¢ ç­‰åŒ Colab ä»£ç¢¼ï¼Œæ•ˆæœå®Œå…¨ç›¸åŒ<br>
                                        â€¢ è¼¸å‡ºé€æ˜ PNG æ ¼å¼<br>
                                        â€¢ é©åˆç”¢å“ç…§ã€äººåƒç…§
                                    </span>
                                </label>
                            </div>

                            <!-- å¿«é€Ÿé è¨­æŒ‰éˆ• -->
                            <div class="bg-purple-50 p-4 rounded-xl border-2 border-purple-200">
                                <h3 class="text-lg font-bold text-purple-800 mb-3">âš¡ å¿«é€Ÿé è¨­çµ„åˆï¼ˆä¸€éµå¥—ç”¨ï¼‰</h3>
                                <div class="grid grid-cols-2 gap-2">
                                    <button onclick="applyPreprocessPreset('remove_background_only')" class="preset-btn bg-gradient-to-r from-purple-600 to-pink-600 text-white">
                                        ğŸ¨ åƒ…å»èƒŒæ™¯
                                    </button>
                                    <button onclick="applyPreprocessPreset('photo_optimize')" class="preset-btn bg-gradient-to-r from-blue-600 to-cyan-600 text-white">
                                        ğŸ“· ç…§ç‰‡å„ªåŒ–
                                    </button>
                                    <button onclick="applyPreprocessPreset('scan_optimize')" class="preset-btn bg-gradient-to-r from-green-600 to-teal-600 text-white">
                                        ğŸ“„ æƒæå„ªåŒ–
                                    </button>
                                    <button onclick="applyPreprocessPreset('enhance_blurry')" class="preset-btn bg-gradient-to-r from-yellow-500 to-orange-500 text-white">
                                        ğŸ” æ¨¡ç³Šå¢å¼·
                                    </button>
                                </div>
                            </div>

                            <!-- é è¨­é…ç½® -->
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">é è¨­é…ç½®</label>
                                <select id="preprocessPreset" class="w-full border-2 border-purple-200 rounded-xl px-4 py-3">
                                    <option value="custom">è‡ªè¨‚è¨­å®š</option>
                                    <option value="scan_optimize">æƒæä»¶å„ªåŒ–</option>
                                    <option value="photo_optimize">æ‹ç…§æ–‡æª”å„ªåŒ–</option>
                                    <option value="enhance_blurry">æ¨¡ç³Šç…§ç‰‡å¢å¼·</option>
                                    <option value="remove_background_only">åƒ…å»èƒŒæ™¯</option>
                                </select>
                            </div>
                        </div>

                        <!-- é€²åº¦æ¢ï¼ˆä¿®æ­£ 4ï¼‰ -->
                        <div id="preprocessProgress" class="hidden mb-4">
                            <p class="text-sm font-bold text-gray-700 mb-2">è™•ç†é€²åº¦</p>
                            <div class="w-full bg-gray-200 rounded-full h-3">
                                <div id="preprocessProgressBar" class="bg-gradient-to-r from-purple-500 to-pink-500 h-3 rounded-full transition-all duration-300" style="width: 0%"></div>
                            </div>
                            <p id="preprocessProgressText" class="text-xs text-gray-500 mt-2 text-center">0/0</p>
                        </div>

                        <!-- åŸ·è¡ŒæŒ‰éˆ• -->
                        <div class="mt-6 space-y-3">
                            <button id="processPreprocessBtn" disabled class="hidden w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-bold py-4 px-6 rounded-xl shadow-xl text-xl transition transform hover:scale-105">
                                é–‹å§‹å‰è™•ç†
                            </button>
                            <button id="downloadPreprocessBtn" disabled class="hidden w-full bg-gradient-to-r from-green-600 to-teal-600 hover:from-green-700 hover:to-teal-700 text-white font-bold py-4 px-6 rounded-xl shadow-xl text-xl transition transform hover:scale-105">
                                ä¸‹è¼‰è™•ç†çµæœ
                            </button>
                            <button id="sendToOcrBtn" disabled class="hidden w-full bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white font-bold py-4 px-6 rounded-xl shadow-xl text-xl transition transform hover:scale-105">
                                ç™¼é€è‡³ OCR
                            </button>
                        </div>
                    </div>

                    <!-- å‰è™•ç†é è¦½ -->
                    <div id="preprocessPreview" class="bg-white rounded-2xl shadow-xl p-6 hidden">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">è™•ç†çµæœé è¦½</h3>
                        <div id="preprocessImages" class="grid grid-cols-2 gap-4 max-h-96 overflow-y-auto"></div>
                    </div>
                </div>

         
                <div id="tab-video-content" class="tab-content">
                    <div class="bg-white rounded-2xl shadow-xl p-6">
                        <h2 class="text-2xl font-bold mb-4 text-gray-800">å½±ç‰‡æˆªåœ–</h2>
                        
                        <div id="videoDropZone" class="drop-zone rounded-xl p-8 text-center cursor-pointer mb-4 bg-gray-50 hover:bg-gray-100 border-2 border-dashed border-blue-300">
                            <svg class="mx-auto h-12 w-12 text-blue-500" stroke="currentColor" fill="none" viewBox="0 0 48 48">
                                <path d="M12 8v28l16-14L12 8z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M36 8v28" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <p class="mt-3 text-lg font-medium text-gray-700">æ‹–æ”¾å½±ç‰‡åˆ°é€™è£¡</p>
                            <p class="mt-1 text-sm text-gray-500">æ”¯æ´ MP4ã€AVIã€MOVã€MKV</p>
                            <input type="file" id="videoFileInput" accept="video/*" class="hidden">
                        </div>

                        <!-- å½±ç‰‡è³‡è¨Š -->
                        <div id="videoInfo" class="hidden mb-4 p-4 bg-blue-50 rounded-xl border-2 border-blue-200">
                            <h4 class="font-bold text-blue-800 mb-2">å½±ç‰‡è³‡è¨Š</h4>
                            <div id="videoInfoContent" class="text-sm text-blue-700"></div>
                        </div>

                        <!-- æˆªåœ–è¨­å®š -->
                        <div id="videoSettings" class="space-y-4 mb-4 hidden">
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">æˆªåœ–æ–¹å¼</label>
                                <select id="extractionMethod" class="w-full border-2 border-blue-200 rounded-xl px-4 py-3">
                                    <option value="fixed_count">å›ºå®šæ•¸é‡ (100å¼µ)</option>
                                    <option value="fixed_interval">å›ºå®šé–“éš” (æ¯ç§’5å¼µ)</option>
                                    <option value="scene_change">å ´æ™¯è®ŠåŒ–åµæ¸¬</option>
                                </select>
                            </div>

                            <div id="frameCountSetting" class="hidden">
                                <label class="block text-sm font-bold text-gray-700 mb-2">ç¸½å¹€æ•¸</label>
                                <input type="number" id="totalFrames" min="1" max="1000" value="1000" class="w-full border-2 border-blue-200 rounded-xl px-4 py-3">
                            </div>

                            <div id="intervalSetting" class="hidden">
                                <label class="block text-sm font-bold text-gray-700 mb-2">æ¯ç§’å¼µæ•¸</label>
                                <input type="number" id="frameInterval" min="1" max="30" value="5" class="w-full border-2 border-blue-200 rounded-xl px-4 py-3">
                            </div>

                            <!-- ä¿®æ­£ 1ï¼šå ´æ™¯è®ŠåŒ–åµæ¸¬è¨­å®šï¼ˆæ–°å¢ï¼‰ -->
                            <div id="sceneChangeSettings" class="hidden">
                                <label class="block text-sm font-bold text-gray-700 mb-2">å ´æ™¯è®ŠåŒ–æ•æ„Ÿåº¦</label>
                                <input type="range" id="sceneSensitivity" min="0.1" max="1" step="0.1" value="0.5" class="w-full h-2 bg-gray-200 rounded-lg">
                                <div class="flex justify-between text-xs text-gray-500 mt-1">
                                    <span>ä½ (æ›´å¤šå¹€)</span>
                                    <span id="sensitivityLabel">ä¸­ (0.5)</span>
                                    <span>é«˜ (æ›´å°‘å¹€)</span>
                                </div>
                            </div>

                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">è¼¸å‡ºæ ¼å¼</label>
                                <select id="outputFormat" class="w-full border-2 border-blue-200 rounded-xl px-4 py-3">
                                    <option value="jpg">JPG (é«˜å£“ç¸®)</option>
                                    <option value="png">PNG (é«˜å“è³ª)</option>
                                </select>
                            </div>
                        </div>

                        <!-- åŸ·è¡ŒæŒ‰éˆ• -->
                        <div class="mt-6 space-y-3">
                            <button id="extractFramesBtn" class="hidden w-full bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white font-bold py-4 px-6 rounded-xl shadow-xl text-xl transition transform hover:scale-105">
                                é–‹å§‹æˆªåœ–
                            </button>
                            <button id="downloadFramesBtn" class="hidden w-full bg-gradient-to-r from-green-600 to-teal-600 hover:from-green-700 hover:to-teal-700 text-white font-bold py-4 px-6 rounded-xl shadow-xl text-xl transition transform hover:scale-105">
                                ä¸‹è¼‰æˆªåœ–
                            </button>
                            <button id="sendFramesToOcrBtn" class="hidden w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-bold py-4 px-6 rounded-xl shadow-xl text-xl transition transform hover:scale-105">
                                ç™¼é€åˆ° OCR
                            </button>
                        </div>
                    </div>

                    <!-- æˆªåœ–é è¦½ï¼ˆé€™å°±æ˜¯æˆªåœ–çµæœï¼‰ -->
                    <div id="framesPreview" class="bg-white rounded-2xl shadow-xl p-6 hidden mt-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">ğŸ“¸ æˆªåœ–çµæœ</h3>
                        <div class="flex justify-between items-center mb-4">
                            <span id="framesCount" class="text-sm text-gray-600">å·²é¸æ“‡ 0 å¼µ</span>
                            <div class="space-x-2">
                                <button id="selectAllFrames" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg text-sm">å…¨é¸</button>
                                <button id="deselectAllFrames" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg text-sm">å…¨ä¸é¸</button>
                            </div>
                        </div>
                        <div id="framesGrid" class="grid grid-cols-3 gap-3 max-h-96 overflow-y-auto"></div>
                    </div>
                </div>

            </div>

           
            <div class="xl:col-span-2 bg-white rounded-2xl shadow-2xl p-8">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-3xl font-bold text-gray-800" id="resultTitle">è¾¨è­˜çµæœ</h2>
                    <div class="space-x-3">
                        <button id="copyBtn" class="hidden bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-bold py-3 px-6 rounded-xl shadow-lg transition transform hover:scale-105">
                            è¤‡è£½å…¨éƒ¨
                        </button>
                        <button id="downloadBtn" class="hidden bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-bold py-3 px-6 rounded-xl shadow-lg transition transform hover:scale-105">
                            ä¸‹è¼‰ TXT
                        </button>
                    </div>
                </div>

                <!-- é€²åº¦æ¢ï¼ˆä¿®æ­£ 8ï¼‰ -->
                <div id="progressInfo" class="hidden mb-6">
                    <div class="text-center">
                        <div class="inline-flex items-center space-x-2 text-sm font-medium">
                            <span>é€²åº¦ï¼š</span>
                            <span id="progressCurrent" class="text-purple-600 font-bold">0</span>
                            <span>/ <span id="progressTotal">0</span> é </span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-3 mt-2">
                            <div id="progressBar" class="bg-gradient-to-r from-purple-500 to-pink-500 h-3 rounded-full transition-all duration-500" style="width: 0%"></div>
                        </div>
                        <div class="text-xs text-gray-500 mt-2" id="progressConfig">é…ç½®ä¿¡æ¯</div>
                    </div>
                </div>

                <!-- çµæœå…§å®¹ -->
                <div id="result" class="bg-gray-50 rounded-2xl p-6 min-h-96 max-h-screen overflow-y-auto border-2 border-dashed border-gray-300">
                    <p class="text-center text-gray-400 text-xl mt-32" id="defaultResultText">è«‹ä¸Šå‚³æª”æ¡ˆé–‹å§‹è™•ç†</p>
                </div>

                <!-- æ‰¹æ¬¡æ§åˆ¶ -->
                <div id="batchControls" class="hidden mt-6 flex space-x-4">
                    <button id="continueBtn" class="flex-1 bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-4 px-6 rounded-xl shadow-xl transition transform hover:scale-105">
                        ç¹¼çºŒä¸‹ä¸€æ‰¹
                    </button>
                    <button id="stopBtn" class="flex-1 bg-red-500 hover:bg-red-600 text-white font-bold py-4 px-6 rounded-xl shadow-xl transition transform hover:scale-105">
                        åœæ­¢æ‰¹æ¬¡
                    </button>
                </div>

                <!-- æˆåŠŸæç¤º -->
                <div id="success" class="hidden mt-6 bg-gradient-to-r from-green-500 to-emerald-600 text-white text-center font-bold text-2xl py-6 rounded-2xl shadow-2xl">
                    <span id="successMessage">å…¨éƒ¨å®Œæˆï¼</span>
                </div>

                <!-- éŒ¯èª¤æç¤ºï¼ˆä¿®æ­£ 10ï¼‰ -->
                <div id="error" class="hidden mt-6 bg-red-100 border-2 border-red-400 text-red-700 px-6 py-4 rounded-xl font-bold" role="alert"></div>
            </div>
        </div>

        <!-- Loading é®ç½© -->
        <div id="loading" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-2xl p-10 shadow-2xl text-center">
                <div class="spinner mx-auto mb-4"></div>
                <p class="text-xl font-bold text-gray-800" id="loadingText">è™•ç†ä¸­...</p>
                <p class="text-sm text-gray-600 mt-2" id="loadingSubtext">è«‹ç¨å€™</p>
            </div>
        </div>
    </div>

    <!-- è¼‰å…¥ app.js -->
    <script src="/static/app.js?v=2"></script>

    <!-- å…§åµŒ JSï¼šæ¨™ç±¤åˆ‡æ›ã€é è¨­é…ç½®ã€å¿«é€ŸåŠŸèƒ½ -->
    <script>
        // æ¨™ç±¤åˆ‡æ›åŠŸèƒ½ï¼ˆå«ç‹€æ…‹ç®¡ç†ï¼‰
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    // ===== æª¢æŸ¥TabæŒ‰éˆ•æ˜¯å¦ç¦ç”¨ï¼ˆç¨ç«‹å‰è™•ç†Tabå·²å‡çµï¼‰ =====
                    if (this.disabled) {
                        // é¡¯ç¤ºæç¤º
                        if (typeof showError === 'function') {
                            showError('ç¨ç«‹å‰è™•ç†åŠŸèƒ½å·²ç¦ç”¨ï¼Œè«‹ä½¿ç”¨ OCR Tab æˆ–å½±ç‰‡æˆªåœ– Tab ä¸­çš„å‰è™•ç†åŠŸèƒ½');
                        } else {
                            alert('ç¨ç«‹å‰è™•ç†åŠŸèƒ½å·²ç¦ç”¨ï¼Œè«‹ä½¿ç”¨ OCR Tab æˆ–å½±ç‰‡æˆªåœ– Tab ä¸­çš„å‰è™•ç†åŠŸèƒ½');
                        }
                        return; // å®Œå…¨é˜»æ­¢å¾ŒçºŒåŸ·è¡Œ
                    }
                    
                    const tabName = this.id.replace('tab-', '');
                    
                    // æ ¹æ“šåˆ‡æ›çš„ Tab åŸ·è¡Œå°æ‡‰çš„ç‹€æ…‹æ¸…ç†
                    if (tabName === 'ocr') {
                        // åˆ‡æ›åˆ° OCR Tab
                        if (typeof switchToOcrTab === 'function') {
                            switchToOcrTab();
                        }
                    } else if (tabName === 'video') {
                        // åˆ‡æ›åˆ°å½±ç‰‡ Tab
                        if (typeof switchToVideoTab === 'function') {
                            switchToVideoTab();
                        }
                    } else if (tabName === 'preprocess') {
                        // TabæŒ‰éˆ•æœªç¦ç”¨ï¼šå…è¨±åˆ‡æ›ï¼ˆPDFå‰è™•ç†æ¨¡å¼ï¼‰
                        if (typeof switchToPreprocessTab === 'function') {
                            switchToPreprocessTab();
                        }
                    }
                    
                    // ç§»é™¤æ‰€æœ‰ active
                    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active', 'bg-purple-600', 'text-white'));
                    document.querySelectorAll('.tab-btn').forEach(b => b.classList.add('bg-gray-200', 'text-gray-700'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    // è¨­å®šç•¶å‰ active
                    this.classList.remove('bg-gray-200', 'text-gray-700');
                    this.classList.add('active', 'bg-purple-600', 'text-white');
                    
                    const tabId = this.id + '-content';
                    const tabContent = document.getElementById(tabId);
                    if (tabContent) {
                        tabContent.classList.add('active');
                    } else {
                        console.error('æ‰¾ä¸åˆ° tab å…§å®¹å…ƒç´ :', tabId);
                    }
                    
                    // æ›´æ–°çµæœæ¨™é¡Œï¼ˆå½±ç‰‡æˆªåœ–ä¸ä½¿ç”¨æ­¤å€åŸŸï¼Œæ‰€ä»¥ä¸æ›´æ–°ï¼‰
                    if (tabName !== 'video') {
                        const titles = {
                            'ocr': 'è¾¨è­˜çµæœ',
                            'preprocess': 'å‰è™•ç†çµæœ'
                        };
                        const titleEl = document.getElementById('resultTitle');
                        if (titleEl) {
                            titleEl.textContent = titles[tabName] || 'è™•ç†çµæœ';
                        }
                    }
                });
            });

            // åˆå§‹åŒ–æˆªåœ–æ–¹å¼é¡¯ç¤º
            const extractionMethod = document.getElementById('extractionMethod');
            if (extractionMethod) {
                extractionMethod.dispatchEvent(new Event('change'));
            }
        });

        // ç…§ç‰‡å‰è™•ç†é è¨­é…ç½®
        const PREPROCESS_PRESETS = {
            'remove_background_only': {
                name: 'åƒ…å»èƒŒæ™¯',
                auto_rotate: false,
                enhance: false,
                remove_shadows: false,
                binarize: false,
                remove_bg: true
            },
            'photo_optimize': {
                name: 'ç…§ç‰‡å„ªåŒ–',
                auto_rotate: true,
                enhance: true,
                remove_shadows: true,
                binarize: false,
                remove_bg: false
            },
            'scan_optimize': {
                name: 'æƒæå„ªåŒ–',
                auto_rotate: true,
                enhance: true,
                remove_shadows: true,
                binarize: true,
                remove_bg: false
            },
            'enhance_blurry': {
                name: 'æ¨¡ç³Šå¢å¼·',
                auto_rotate: false,
                enhance: true,
                remove_shadows: false,
                binarize: false,
                remove_bg: false
            }
        };

        // å¥—ç”¨å‰è™•ç†é è¨­ï¼ˆä¿®æ­£ 6ï¼‰
        function applyPreprocessPreset(presetName) {
            const preset = PREPROCESS_PRESETS[presetName];
            
            if (preset) {
                // å–æ¶ˆæ‰€æœ‰å‹¾é¸
                document.querySelectorAll('#preprocessSettings input[type="checkbox"]').forEach(cb => {
                    cb.checked = false;
                });
                
                // å¥—ç”¨é è¨­
                document.getElementById('autoRotate').checked = preset.auto_rotate;
                document.getElementById('enhance').checked = preset.enhance;
                document.getElementById('removeShadows').checked = preset.remove_shadows;
                document.getElementById('binarize').checked = preset.binarize;
                document.getElementById('removeBg').checked = preset.remove_bg;
                
                // æ›´æ–°ä¸‹æ‹‰é¸å–®
                const presetSelect = document.getElementById('preprocessPreset');
                if (presetSelect) {
                    presetSelect.value = presetName;
                }
            }
        }

        // ç¸®æ”¾é è¦½åŠŸèƒ½
        function zoomPreview(factor) {
            const img = document.getElementById('previewImage');
            if (img) {
                const current = img.style.transform.match(/scale\(([^)]+)\)/);
                const scale = current ? parseFloat(current[1]) : 1;
                img.style.transform = `scale(${scale * factor})`;
            }
        }

        // æ³¨æ„ï¼šä»¥ä¸‹äº‹ä»¶ç›‘å¬å™¨å·²ç§»è‡³ app.js çš„ DOMContentLoaded ä¸­ç»Ÿä¸€ç®¡ç†
        // ä¸ºé¿å…é‡å¤ç»‘å®šï¼Œæ­¤å¤„å·²æ³¨é‡Š
        // å¦‚éœ€ä¿®æ”¹ï¼Œè¯·åˆ° app.js çš„ DOMContentLoaded åŒºå—ä¸­ä¿®æ”¹
        
        /*
        // æˆªåœ–æ–¹å¼åˆ‡æ›ï¼ˆä¿®æ­£ 1ï¼šæ–°å¢å ´æ™¯è®ŠåŒ–é¸é …ï¼‰
        document.getElementById('extractionMethod').addEventListener('change', function() {
            document.getElementById('frameCountSetting').classList.add('hidden');
            document.getElementById('intervalSetting').classList.add('hidden');
            document.getElementById('sceneChangeSettings').classList.add('hidden');
            
            if (this.value === 'fixed_count') {
                document.getElementById('frameCountSetting').classList.remove('hidden');
            } else if (this.value === 'fixed_interval') {
                document.getElementById('intervalSetting').classList.remove('hidden');
            } else if (this.value === 'scene_change') {
                document.getElementById('sceneChangeSettings').classList.remove('hidden');
            }
        });

        // å ´æ™¯æ•æ„Ÿåº¦æ»‘å¡Šé¡¯ç¤ºï¼ˆä¿®æ­£ 1ï¼‰
        document.getElementById('sceneSensitivity').addEventListener('input', function() {
            const labels = ['ä½ (æ›´å¤šå¹€)', 'ä¸­ (0.5)', 'é«˜ (æ›´å°‘å¹€)'];
            const index = Math.round((this.value - 0.1) / 0.9 * 2);
            document.getElementById('sensitivityLabel').textContent = `${labels[index]} (${this.value})`;
        });

        // é è¨­é…ç½®ä¸‹æ‹‰é¸å–®åŒæ­¥ï¼ˆä¿®æ­£ 6ï¼‰
        document.getElementById('preprocessPreset').addEventListener('change', function() {
            const presets = {
                'scan_optimize': { autoRotate: true, enhance: true, removeShadows: true, binarize: true, removeBg: false },
                'photo_optimize': { autoRotate: true, enhance: true, removeShadows: true, binarize: false, removeBg: false },
                'enhance_blurry': { autoRotate: false, enhance: true, removeShadows: false, binarize: false, removeBg: false },
                'remove_background_only': { autoRotate: false, enhance: false, removeShadows: false, binarize: false, removeBg: true }
            };
            
            const preset = presets[this.value];
            if (preset && this.value !== 'custom') {
                document.getElementById('autoRotate').checked = preset.autoRotate;
                document.getElementById('enhance').checked = preset.enhance;
                document.getElementById('removeShadows').checked = preset.removeShadows;
                document.getElementById('binarize').checked = preset.binarize;
                document.getElementById('removeBg').checked = preset.removeBg;
            }
        });
        */
    </script>
</body>
</html>